{"version":3,"sources":["../../../../../assets/Script/Controller/assets/Script/Controller/BloodController.js"],"names":["cc","Class","extends","Component","properties","bloodbar","default","type","ProgressBar","totalBlood","get","_totalblood","set","value","currentBlood","_currentblood","timeCallBack","bloodAnim","pause","defaultClip","name","setCurrentTime","currentTime","onLoad","getComponent","Animation","totalTime","duration","node","on","_damage","playTime","playState","play","resume","scheduleOnce","start","update","dt"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,kBAAS;AACLC,qBAAQ,IADH;AAELC,kBAAKP,GAAGQ;AAFH,SADD;AAKRC,oBAAW;AACPC,eADO,iBACF;AACD,uBAAO,KAAKC,WAAZ;AACH,aAHM;AAIPC,eAJO,eAIHC,KAJG,EAIG;AACN,qBAAKF,WAAL,GAAmBE,KAAnB;AACH;AANM,SALH;AAaRC,sBAAa;AACTJ,eADS,iBACJ;AACD,uBAAO,KAAKK,aAAZ;AACH,aAHQ;AAITH,eAJS,eAILC,KAJK,EAIC;AACN,qBAAKE,aAAL,GAAqBF,KAArB;AACH;AANQ;AAbL,KAHP;;AA0BL;AACAG,gBA3BK,0BA2BS;AACV,aAAKC,SAAL,CAAeC,KAAf,CAAqB,KAAKD,SAAL,CAAeE,WAAf,CAA2BC,IAAhD;AACA,aAAKH,SAAL,CAAeI,cAAf,CAA8B,KAAKC,WAAnC,EAA+C,KAAKL,SAAL,CAAeE,WAAf,CAA2BC,IAA1E;AACH,KA9BI;AA+BLG,UA/BK,oBA+BK;AACN,aAAKN,SAAL,GAAiB,KAAKO,YAAL,CAAkBxB,GAAGyB,SAArB,CAAjB;AACA,aAAKC,SAAL,GAAiB,KAAKT,SAAL,CAAeE,WAAf,CAA2BQ,QAA5C;AACA,aAAKb,YAAL,GAAoB,KAAKL,UAAzB;AACA,aAAKmB,IAAL,CAAUC,EAAV,CAAa,QAAb,EAAsB,UAASC,OAAT,EAAiB;AACnC;AACA,iBAAKC,QAAL,GAAgBD,UAAQ,KAAKrB,UAAb,GAAwB,KAAKiB,SAA7C;AACA,gBAAG,KAAKZ,YAAL,IAAmB,KAAKL,UAA3B,EAAsC;AAClC,qBAAKuB,SAAL,GAAiB,KAAKf,SAAL,CAAegB,IAAf,CAAoB,KAAKhB,SAAL,CAAeE,WAAf,CAA2BC,IAA/C,CAAjB;AACH,aAFD,MAEK;AACD,qBAAKY,SAAL,GAAiB,KAAKf,SAAL,CAAeiB,MAAf,CAAsB,KAAKjB,SAAL,CAAeE,WAAf,CAA2BC,IAAjD,CAAjB;AACH;AACD,iBAAKe,YAAL,CAAkB,KAAKnB,YAAvB,EAAqC,KAAKe,QAA1C;AACA,iBAAKjB,YAAL,GAAkB,KAAKA,YAAL,GAAkBgB,OAApC;AACA,iBAAKR,WAAL,GAAmB,KAAKI,SAAL,GAAe,KAAKZ,YAAL,GAAkB,KAAKL,UAAvB,GAAkC,KAAKiB,SAAzE;AAEH,SAZD,EAYE,IAZF;AAaH,KAhDI;AAkDLU,SAlDK,mBAkDI,CAER,CApDI;AAsDLC,UAtDK,kBAsDGC,EAtDH,EAsDO;AACR;AACA;AACA;AACA;AACA;AACA;AACH;AA7DI,CAAT","file":"BloodController.js","sourceRoot":"../../../../../assets/Script/Controller","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bloodbar:{\n            default:null,\n            type:cc.ProgressBar\n        },\n        totalBlood:{\n            get(){\n                return this._totalblood;\n            },\n            set(value){\n                this._totalblood = value;\n            }\n        },\n        currentBlood:{\n            get(){\n                return this._currentblood;\n            },\n            set(value){\n                this._currentblood = value;\n            }\n        },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n    timeCallBack(){\n        this.bloodAnim.pause(this.bloodAnim.defaultClip.name);\n        this.bloodAnim.setCurrentTime(this.currentTime,this.bloodAnim.defaultClip.name);\n    },\n    onLoad () {\n        this.bloodAnim = this.getComponent(cc.Animation);\n        this.totalTime = this.bloodAnim.defaultClip.duration;\n        this.currentBlood = this.totalBlood;\n        this.node.on('damage',function(_damage){\n            // cc.log(_damage);\n            this.playTime = _damage/this.totalBlood*this.totalTime;\n            if(this.currentBlood==this.totalBlood){\n                this.playState = this.bloodAnim.play(this.bloodAnim.defaultClip.name);\n            }else{\n                this.playState = this.bloodAnim.resume(this.bloodAnim.defaultClip.name);\n            }\n            this.scheduleOnce(this.timeCallBack, this.playTime);\n            this.currentBlood=this.currentBlood-_damage;\n            this.currentTime = this.totalTime-this.currentBlood/this.totalBlood*this.totalTime;\n            \n        },this)\n    },\n\n    start () {\n\n    },\n\n    update (dt) {\n        // if(this.playState){\n        //     if(this.playState.time>=this.playTime){\n        //         this.bloodAnim.pause(this.bloodAnim.defaultClip.name);\n        //         // this.bloodAnim.setCurrentTime(this.currentTime,this.bloodAnim.defaultClip.name);\n        //     }\n        // }\n    },\n});\n"]}