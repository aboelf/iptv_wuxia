{"version":3,"sources":["../../../../../assets/Script/Controller/assets/Script/Controller/LineController.js"],"names":["cc","Class","extends","Component","properties","line","Prefab","lines","connectedBalls","drawLines","length","i","j","beginBall","endBall","instantiate","parent","node","push","log","setPosition","getPosition","add","div","t","Vec2","angleBE","sub","x","y","angle","Math","PI","drawLine","clearLines","forEach","v","destroy","clearLastLine","removeFromParent","pop","onLoad","start"],"mappings":"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","file":"LineController.js","sourceRoot":"../../../../../assets/Script/Controller","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        line: cc.Prefab,\n        lines: [],\n        connectedBalls: [],\n        \n    },\n    drawLines() {\n        if (this.connectedBalls.length > 1) {\n            for (let i = 0, j = 1; i < this.connectedBalls.length - 1; i++, j++) {\n                let beginBall = this.connectedBalls[i];\n                let endBall = this.connectedBalls[j];\n                let line = cc.instantiate(this.line);\n                line.parent = this.node;\n                this.lines.push(line)\n                cc.log(this.lines)\n                line.setPosition(endBall.getPosition().add(beginBall.getPosition()).div(2))\n                endBall=endBall;\n                beginBall=beginBall;\n                let t = new cc.Vec2(100,0);\n                let angleBE=beginBall.getPosition().sub(endBall.getPosition());\n                if((angleBE.x<0 && angleBE.y<0) || (angleBE.x>0 && angleBE.y<0)){\n                    line.angle=-(180+t.angle(beginBall.getPosition().sub(endBall.getPosition()))*180/Math.PI);\n                }else if(angleBE.x==0 && angleBE.y<0){\n                    line.angle=t.angle(beginBall.getPosition().sub(endBall.getPosition()))*180/Math.PI\n                }else{\n                    line.angle=-(180-t.angle(beginBall.getPosition().sub(endBall.getPosition()))*180/Math.PI);\n                }\n            }\n        }\n    },\n    drawLine(){\n        if (this.connectedBalls.length > 1){\n            let beginBall = this.connectedBalls[this.connectedBalls.length-2];\n            let endBall = this.connectedBalls[this.connectedBalls.length-1];\n            let line = cc.instantiate(this.line);\n            line.parent = this.node;\n            this.lines.push(line)\n            line.setPosition(endBall.getPosition().add(beginBall.getPosition()).div(2));\n            let t = new cc.Vec2(100,0);\n            let angleBE=beginBall.getPosition().sub(endBall.getPosition());\n            if((angleBE.x<0 && angleBE.y<0) || (angleBE.x>0 && angleBE.y<0)){\n                line.angle=-(180+t.angle(beginBall.getPosition().sub(endBall.getPosition()))*180/Math.PI);\n            }else if(angleBE.x==0 && angleBE.y<0){\n                line.angle=t.angle(beginBall.getPosition().sub(endBall.getPosition()))*180/Math.PI\n            }else{\n                line.angle=-(180-t.angle(beginBall.getPosition().sub(endBall.getPosition()))*180/Math.PI);\n            }\n        }\n    },\n    clearLines(){\n        this.lines.forEach(function(v){\n            v.destroy();\n        })\n        this.lines = [];\n    },\n    clearLastLine(){\n        this.lines[this.lines.length-1].destroy();\n        this.lines[this.lines.length-1].removeFromParent(false);\n        this.lines.pop();\n        cc.log(this.lines);\n    },\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n\n        // this.node.children[0].on(cc.Node.EventType.TOUCH_MOVE,function(e){\n        //     this.setPosition(this.parent.convertToNodeSpaceAR(e.touch._point));\n        // },this.node.children[0])\n    },\n\n    start() {\n\n    },\n\n    // update (dt) {},\n});"]}